(self.webpackChunkclipz=self.webpackChunkclipz||[]).push([[829],{3327:(S,C,l)=>{"use strict";l.r(C),l.d(C,{defaultOptions:()=>U,fetchFile:()=>V,getCreateFFmpegCore:()=>g});const U={corePath:`https://unpkg.com/@ffmpeg/core@${l(3681).devDependencies["@ffmpeg/core"].substring(1)}/dist/ffmpeg-core.js`};var h=l(5861),e=l(6945),D=l(3630);const R=function(){var J=(0,h.Z)(function*(_,E){(0,e.log)("info",`fetch ${_}`);const v=yield(yield fetch(_)).arrayBuffer();(0,e.log)("info",`${_} file size = ${v.byteLength} bytes`);const Z=new Blob([v],{type:E}),T=URL.createObjectURL(Z);return(0,e.log)("info",`${_} blob URL = ${T}`),T});return function(E,v){return J.apply(this,arguments)}}(),g=function(){var J=(0,h.Z)(function*({corePath:_,workerPath:E,wasmPath:v}){if(typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope){if("string"!=typeof _)throw Error("corePath should be a string!");const M=new URL(_,"file:///E:/code/projects/udemy/Angular/clipz/node_modules/@ffmpeg/ffmpeg/src/browser/getCreateFFmpegCore.js").href,I=yield R(M,"application/javascript"),Y=yield R(void 0!==v?v:M.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),j=yield R(void 0!==E?E:M.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore>"u"?new Promise(G=>{if(globalThis.importScripts(I),typeof createFFmpegCore>"u")throw Error((0,D.CREATE_FFMPEG_CORE_IS_NOT_DEFINED)(M));(0,e.log)("info","ffmpeg-core.js script loaded"),G({createFFmpegCore,corePath:I,wasmPath:Y,workerPath:j})}):((0,e.log)("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:I,wasmPath:Y,workerPath:j}))}if("string"!=typeof _)throw Error("corePath should be a string!");const Z=new URL(_,"file:///E:/code/projects/udemy/Angular/clipz/node_modules/@ffmpeg/ffmpeg/src/browser/getCreateFFmpegCore.js").href,T=yield R(Z,"application/javascript"),P=yield R(void 0!==v?v:Z.replace("ffmpeg-core.js","ffmpeg-core.wasm"),"application/wasm"),$=yield R(void 0!==E?E:Z.replace("ffmpeg-core.js","ffmpeg-core.worker.js"),"application/javascript");return typeof createFFmpegCore>"u"?new Promise(M=>{const I=document.createElement("script"),Y=()=>{if(I.removeEventListener("load",Y),typeof createFFmpegCore>"u")throw Error((0,D.CREATE_FFMPEG_CORE_IS_NOT_DEFINED)(Z));(0,e.log)("info","ffmpeg-core.js script loaded"),M({createFFmpegCore,corePath:T,wasmPath:P,workerPath:$})};I.src=T,I.type="text/javascript",I.addEventListener("load",Y),document.getElementsByTagName("head")[0].appendChild(I)}):((0,e.log)("info","ffmpeg-core.js script is loaded already"),Promise.resolve({createFFmpegCore,corePath:T,wasmPath:P,workerPath:$}))});return function(E){return J.apply(this,arguments)}}(),V=function(){var J=(0,h.Z)(function*(_){let E=_;return typeof _>"u"?new Uint8Array:("string"==typeof _?E=/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(_)?atob(_.split(",")[1]).split("").map(v=>v.charCodeAt(0)):yield(yield fetch(new URL(_,"file:///E:/code/projects/udemy/Angular/clipz/node_modules/@ffmpeg/ffmpeg/src/browser/fetchFile.js").href)).arrayBuffer():(_ instanceof File||_ instanceof Blob)&&(E=yield(J=>new Promise((_,E)=>{const v=new FileReader;v.onload=()=>{_(v.result)},v.onerror=({target:{error:{code:Z}}})=>{E(Error(`File could not be read! Code=${Z}`))},v.readAsArrayBuffer(J)}))(_)),new Uint8Array(E))});return function(E){return J.apply(this,arguments)}}()},6151:S=>{S.exports={defaultArgs:["./ffmpeg","-nostdin","-y"],baseOptions:{log:!1,logger:()=>{},progress:()=>{},corePath:""}}},9639:(S,C,l)=>{var F=l(7156).default;const{defaultArgs:w,baseOptions:U}=l(6151),h=l(8333),{defaultOptions:e,getCreateFFmpegCore:D}=l(3327),{version:R}=l(3681),g=Error("ffmpeg.wasm is not ready, make sure you have completed load().");S.exports=(A={})=>{const{log:V,logger:J,progress:_,...E}={...U,...e,...A};let v=null,Z=null,T=null,P=null,$=!1,M=()=>{},I=V,Y=_,j=0,G=0,W=!1,H=0;const B=(c,f)=>{M({type:c,message:f}),I&&console.log(`[${c}] ${f}`)},ie=c=>{const[f,m,y]=c.split(":");return 60*parseFloat(f)*60+60*parseFloat(m)+parseFloat(y)},K=({type:c,message:f})=>{B(c,f),((c,f)=>{if("string"==typeof c)if(c.startsWith("  Duration")){const m=c.split(", ")[0].split(": ")[1],y=ie(m);f({duration:y,ratio:H}),(0===j||j>y)&&(j=y,W=!0)}else if(W&&c.startsWith("    Stream")){const m=c.match(/([\d.]+) fps/);if(m){const y=parseFloat(m[1]);G=j*y}else G=0;W=!1}else if(c.startsWith("frame")||c.startsWith("size")){const m=c.split("time=")[1].split(" ")[0],y=ie(m),Q=c.match(/frame=\s*(\d+)/);if(G&&Q){const k=parseFloat(Q[1]);H=Math.min(k/G,1)}else H=y/j;f({ratio:H,time:y})}else c.startsWith("video:")&&(f({ratio:1}),j=0)})(f,Y),(c=>{"FFMPEG_END"===c&&null!==T&&(T(),T=null,P=null,$=!1)})(f)},X=function(){var c=F(function*(){if(B("info","load ffmpeg-core"),null!==v)throw Error("ffmpeg.wasm was loaded, you should not load it again, use ffmpeg.isLoaded() to check next time.");{B("info","loading ffmpeg-core");const{createFFmpegCore:f,corePath:m,workerPath:y,wasmPath:Q}=yield D(E);v=yield f({mainScriptUrlOrBlob:m,printErr:k=>K({type:"fferr",message:k}),print:k=>K({type:"ffout",message:k}),locateFile:(k,z)=>{if(typeof window<"u"||typeof WorkerGlobalScope<"u"){if(typeof Q<"u"&&k.endsWith("ffmpeg-core.wasm"))return Q;if(typeof y<"u"&&k.endsWith("ffmpeg-core.worker.js"))return y}return z+k}}),Z=v.cwrap(E.mainName||"proxy_main","number",["number","number"]),B("info","ffmpeg-core loaded")}});return function(){return c.apply(this,arguments)}}();return B("info",`use ffmpeg.wasm v${R}`),{setProgress:c=>{Y=c},setLogger:c=>{M=c},setLogging:c=>{I=c},load:X,isLoaded:()=>null!==v,run:(...c)=>{if(B("info",`run ffmpeg command: ${c.join(" ")}`),null===v)throw g;if($)throw Error("ffmpeg.wasm can only run one command at a time");return $=!0,new Promise((f,m)=>{const y=[...w,...c].filter(Q=>0!==Q.length);T=f,P=m,Z(...h(v,y))})},exit:()=>{if(null===v)throw g;P&&P("ffmpeg has exited"),$=!1;try{v.exit(1)}catch(c){B(c.message),P&&P(c)}finally{v=null,Z=null,T=null,P=null}},FS:(c,...f)=>{if(B("info",`run FS.${c} ${f.map(m=>"string"==typeof m?m:`<${m.length} bytes binary file>`).join(" ")}`),null===v)throw g;{let m=null;try{m=v.FS[c](...f)}catch{throw Error("readdir"===c?`ffmpeg.FS('readdir', '${f[0]}') error. Check if the path exists, ex: ffmpeg.FS('readdir', '/')`:"readFile"===c?`ffmpeg.FS('readFile', '${f[0]}') error. Check if the path exists`:"Oops, something went wrong in FS operation.")}return m}}}}},260:(S,C,l)=>{l(7854);const F=l(9639),{fetchFile:w}=l(3327);S.exports={createFFmpeg:F,fetchFile:w}},3630:S=>{S.exports={CREATE_FFMPEG_CORE_IS_NOT_DEFINED:l=>`\ncreateFFmpegCore is not defined. ffmpeg.wasm is unable to find createFFmpegCore after loading ffmpeg-core.js from ${l}. Use another URL when calling createFFmpeg():\n\nconst ffmpeg = createFFmpeg({\n  corePath: 'http://localhost:3000/ffmpeg-core.js',\n});\n`}},6945:S=>{let C=!1,l=()=>{};S.exports={logging:C,setLogging:h=>{C=h},setCustomLogger:h=>{l=h},log:(h,e)=>{l({type:h,message:e}),C&&console.log(`[${h}] ${e}`)}}},8333:S=>{S.exports=(C,l)=>{const F=C._malloc(l.length*Uint32Array.BYTES_PER_ELEMENT);return l.forEach((w,U)=>{const h=C.lengthBytesUTF8(w)+1,e=C._malloc(h);C.stringToUTF8(w,e,h),C.setValue(F+Uint32Array.BYTES_PER_ELEMENT*U,e,"i32")}),[l.length,F]}},1829:(S,C,l)=>{"use strict";l.r(C),l.d(C,{VideoModule:()=>Ce});var F=l(6895),w=l(9062),U=l(5861),h=l(1135),e=l(4650),D=l(4411),R=l(1609),g=l(4006),A=l(8549),V=l(235),J=l(3446);function _(r,a){if(1&r&&(e.TgZ(0,"app-alert",9)(1,"p"),e._uU(2),e.qZA()()),2&r){const t=e.oxw();e.Q6J("color",t.alertColor),e.xp6(2),e.Oqu(t.alertMsg)}}const E=function(r,a){return{"opacity-50 bg-blue-400":r,"hover:bg-blue-700":a}};let v=(()=>{class r{constructor(t,o){this.modal=t,this.clipService=o,this.activeClip=null,this.showAlert=!1,this.inSubmission=!1,this.alertColor="blue",this.alertMsg="",this.update=new e.vpe,this.clipID=new g.NI("",{nonNullable:!0}),this.title=new g.NI("",{validators:[g.kI.required,g.kI.minLength(3)],nonNullable:!0}),this.editForm=new g.cw({title:this.title,id:this.clipID})}ngOnChanges(){this.activeClip&&(this.clipID.setValue(this.activeClip.docID),this.title.setValue(this.activeClip.title),this.inSubmission=!1,this.showAlert=!1)}ngOnInit(){this.modal.register("editClip")}ngOnDestroy(){this.modal.unregister("editClip")}submit(){var t=this;return(0,U.Z)(function*(){if(t.activeClip){t.inSubmission=!0,t.showAlert=!0,t.alertColor="blue",t.alertMsg="Please wait! Updating clip";try{yield t.clipService.updateClip(t.clipID.value,t.title.value)}catch{return t.inSubmission=!1,t.alertColor="red",void(t.alertMsg="Something went wrong, try again later")}t.activeClip.title=t.title.value,t.update.emit(t.activeClip),t.inSubmission=!1,t.alertColor="green",t.alertMsg="Success!",setTimeout(()=>{t.showAlert=!1,t.inSubmission=!1,t.alertColor="blue",t.alertMsg=""},2300)}})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(R.Z),e.Y36(D.Y))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-edit"]],inputs:{activeClip:"activeClip"},outputs:{update:"update"},features:[e.TTD],decls:12,vars:7,consts:[["modalID","editClip"],[1,"text-2xl","font-bold"],[3,"color",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"mt-4"],[1,"block","text-xl","mb-4"],["placeholder","Enter Title",3,"control"],[1,"mt-4","text-right"],["type","submit",1,"inline-flex","justify-center","py-2","px-4","border","border-transparent","shadow-sm","rounded-md","text-white","bg-blue-600","focus:outline-none",3,"ngClass"],[3,"color"]],template:function(t,o){1&t&&(e.TgZ(0,"app-modal",0)(1,"p",1),e._uU(2,"Edit Video"),e.qZA(),e.YNc(3,_,3,2,"app-alert",2),e.TgZ(4,"form",3),e.NdJ("ngSubmit",function(){return o.submit()}),e.TgZ(5,"div",4)(6,"label",5),e._uU(7,"Title"),e.qZA(),e._UZ(8,"app-input",6),e.qZA(),e.TgZ(9,"div",7)(10,"button",8),e._uU(11," Update "),e.qZA()()()()),2&t&&(e.xp6(3),e.Q6J("ngIf",o.showAlert),e.xp6(1),e.Q6J("formGroup",o.editForm),e.xp6(4),e.Q6J("control",o.title),e.xp6(2),e.Q6J("ngClass",e.WLB(4,E,o.inSubmission,!o.inSubmission)))},dependencies:[F.mk,F.O5,A.w,V.a,J.z,g._Y,g.JL,g.sg]}),r})();const Z=function(r){return["/","clip",r]};function T(r,a){if(1&r){const t=e.EpF();e.TgZ(0,"div",10)(1,"a",11),e._UZ(2,"img",12),e.qZA(),e.TgZ(3,"div",13)(4,"a",14),e._uU(5),e.qZA(),e.TgZ(6,"a",15),e.NdJ("click",function(p){const O=e.CHM(t).$implicit,N=e.oxw();return e.KtG(N.copyToClipboard(p,O.docID))}),e._uU(7," Copy Link "),e.qZA()(),e.TgZ(8,"div",16)(9,"a",17),e.NdJ("click",function(p){const O=e.CHM(t).$implicit,N=e.oxw();return e.KtG(N.openModal(p,O))}),e.TgZ(10,"span",18),e._uU(11,"build"),e.qZA()(),e.TgZ(12,"a",19),e.NdJ("click",function(p){const O=e.CHM(t).$implicit,N=e.oxw();return e.KtG(N.deleteClip(p,O))}),e.TgZ(13,"span",18),e._uU(14,"delete"),e.qZA()()()()}if(2&r){const t=a.$implicit;e.xp6(1),e.Q6J("routerLink",e.VKq(4,Z,t.docID)),e.xp6(1),e.Q6J("src",t.screenshotURL,e.LSH),e.xp6(3),e.hij(" ",t.title," "),e.xp6(1),e.Q6J("routerLink",e.VKq(6,Z,t.docID))}}let P=(()=>{class r{constructor(t,o,p,x){this.router=t,this.route=o,this.clipService=p,this.modal=x,this.videoOrder="1",this.selected="",this.clips=[],this.activeClip=null,this.sort$=new h.X(this.videoOrder)}ngOnInit(){this.route.queryParams.subscribe(t=>{this.videoOrder="2"===t.sort?t.sort:"1",this.sort$.next(this.videoOrder)}),this.clipService.getUserClips(this.sort$).subscribe(t=>{this.clips=[],t.forEach(o=>{this.clips.push({docID:o.id,uid:o.data().uid,displayName:o.data().displayName,title:o.data().title,fileName:o.data().fileName,url:o.data().url,timestamp:o.data().timestamp,screenshotURL:o.data().screenshotURL,screenshotFileName:o.data().screenshotFileName})})})}sort(t){const{value:o}=t.target;this.router.navigate([],{relativeTo:this.route,queryParams:{sort:o}})}openModal(t,o){t.preventDefault(),this.activeClip=o,this.modal.toggleModal("editClip")}update(t){this.clips.forEach((o,p)=>{o.docID===t.docID&&(this.clips[p].title=t.title)})}deleteClip(t,o){t.preventDefault(),this.clipService.deleteClip(o),this.clips.forEach((p,x)=>{p.docID===o.docID&&this.clips.splice(x,1)})}copyToClipboard(t,o){return(0,U.Z)(function*(){if(t.preventDefault(),!o)return;const p=`${location.origin}/clip/${o}`;yield navigator.clipboard.writeText(p),alert("Link Copied!")})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(w.F0),e.Y36(w.gz),e.Y36(D.Y),e.Y36(R.Z))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-manage"]],decls:13,vars:4,consts:[[1,"container","mx-auto","my-8","bg-secondary","p-6"],[1,"rounded","relative","flex","justify-between"],["routerLink","/upload",1,"bg-blue-400","text-white","py-4","px-10","text-xl"],[1,"text-black","px-8","text-xl","outline-none","appearance-none",3,"change"],["value","1",3,"selected"],["value","2",3,"selected"],[1,"container","mx-auto","my-8"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4"],["class","mt-6 rounded-tl-2xl rounded-br-2xl shadow-xl bg-secondary flex flex-col justify-start",4,"ngFor","ngForOf"],[3,"activeClip","update"],[1,"mt-6","rounded-tl-2xl","rounded-br-2xl","shadow-xl","bg-secondary","flex","flex-col","justify-start"],[3,"routerLink"],["crossorigin","",1,"card-img-top","rounded-tl-2xl","w-full",3,"src"],[1,"p-6","text-2xl"],[1,"font-bold","mb-2"],["href","#",1,"bg-gray-400","text-white","px-2","py-1","ml-2","text-sm","rounded",3,"routerLink","click"],[1,"flex","text-center","text-2xl","bg-gray-800","p-2","mt-auto"],["href","#",1,"flex-1","p-2","border-right","border-r-2","border-gray-700","transition","hover:text-blue-400",3,"click"],[1,"material-icons","text-base"],["href","#",1,"flex-1","p-2","rounded-br-2xl","transition","hover:text-blue-400",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"a",2),e._uU(3,"Upload Videos"),e.qZA(),e.TgZ(4,"select",3),e.NdJ("change",function(x){return o.sort(x)}),e.TgZ(5,"option",4),e._uU(6,"Recent Uploads"),e.qZA(),e.TgZ(7,"option",5),e._uU(8,"Oldest Uploads"),e.qZA()()()(),e.TgZ(9,"div",6)(10,"div",7),e.YNc(11,T,15,8,"div",8),e.qZA()(),e.TgZ(12,"app-edit",9),e.NdJ("update",function(x){return o.update(x)}),e.qZA()),2&t&&(e.xp6(5),e.Q6J("selected","1"===o.videoOrder),e.xp6(2),e.Q6J("selected","2"===o.videoOrder),e.xp6(4),e.Q6J("ngForOf",o.clips),e.xp6(1),e.Q6J("activeClip",o.activeClip))},dependencies:[F.sg,w.rH,g.YN,g.Kr,v]}),r})();var $=l(9841),M=l(4128),I=l(3900);const j={randomUUID:typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let G;const W=new Uint8Array(16);function H(){if(!G&&(G=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!G))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return G(W)}const L=[];for(let r=0;r<256;++r)L.push((r+256).toString(16).slice(1));const X=function K(r,a,t){if(j.randomUUID&&!a&&!r)return j.randomUUID();const o=(r=r||{}).random||(r.rng||H)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,a){t=t||0;for(let p=0;p<16;++p)a[t+p]=o[p];return a}return function B(r,a=0){return(L[r[a+0]]+L[r[a+1]]+L[r[a+2]]+L[r[a+3]]+"-"+L[r[a+4]]+L[r[a+5]]+"-"+L[r[a+6]]+L[r[a+7]]+"-"+L[r[a+8]]+L[r[a+9]]+"-"+L[r[a+10]]+L[r[a+11]]+L[r[a+12]]+L[r[a+13]]+L[r[a+14]]+L[r[a+15]]).toLowerCase()}(o)};var re=l(9260),i=l(377),n=l(1205),s=l(260);let d=(()=>{class r{constructor(){this.isRunning=!1,this.isReady=!1,this.ffmpeg=(0,s.createFFmpeg)({log:!0})}init(){var t=this;return(0,U.Z)(function*(){t.isReady||(yield t.ffmpeg.load(),t.isReady=!0)})()}getScreenshots(t){var o=this;return(0,U.Z)(function*(){o.isRunning=!0;const p=yield(0,s.fetchFile)(t);o.ffmpeg.FS("writeFile",t.name,p);const x=[1,2,3],O=[];x.forEach(ne=>{O.push("-i",t.name,"-ss",`00:00:0${ne}`,"-frames:v","1","-filter:v","scale=510:-1",`output_0${ne}.png`)}),yield o.ffmpeg.run(...O);const N=[];return x.forEach(ne=>{const q=o.ffmpeg.FS("readFile",`output_0${ne}.png`),ee=new Blob([q.buffer],{type:"image/png"}),oe=URL.createObjectURL(ee);N.push(oe)}),o.isRunning=!1,N})()}blobFromURL(t){return(0,U.Z)(function*(){return yield(yield fetch(t)).blob()})()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),u=(()=>{class r{handleEvent(t){t.preventDefault()}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275dir=e.lG2({type:r,selectors:[["","app-event-blocker",""]],hostBindings:function(t,o){1&t&&e.NdJ("drop",function(x){return o.handleEvent(x)})("dragover",function(x){return o.handleEvent(x)})}}),r})();var b=l(1481);let c=(()=>{class r{constructor(t){this.sanitizer=t}transform(t){return this.sanitizer.bypassSecurityTrustUrl(t)}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(b.H7,16))},r.\u0275pipe=e.Yjl({name:"safeURL",type:r,pure:!0}),r})();function f(r,a){1&r&&(e.TgZ(0,"span",5),e._uU(1," refresh "),e.qZA())}function m(r,a){1&r&&(e.TgZ(0,"span",5),e._uU(1," autorenew "),e.qZA())}const y=function(r){return{"bg-blue-400 border-blue-400 border-solid":r}};function Q(r,a){if(1&r){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",8),e.NdJ("dragend",function(){e.CHM(t);const p=e.oxw(2);return e.KtG(p.isDragover=!1)})("dragover",function(){e.CHM(t);const p=e.oxw(2);return e.KtG(p.isDragover=!0)})("dragenter",function(){e.CHM(t);const p=e.oxw(2);return e.KtG(p.isDragover=!0)})("dragleave",function(){e.CHM(t);const p=e.oxw(2);return e.KtG(p.isDragover=!1)})("mouseleave",function(){e.CHM(t);const p=e.oxw(2);return e.KtG(p.isDragover=!1)})("drop",function(p){e.CHM(t);const x=e.oxw(2);return e.KtG(x.storeFile(p))}),e.TgZ(2,"h5"),e._uU(3,"Drop your file here (mp4 only!)"),e.qZA(),e.YNc(4,m,2,0,"span",9),e.qZA(),e.TgZ(5,"input",10),e.NdJ("change",function(p){e.CHM(t);const x=e.oxw(2);return e.KtG(x.storeFile(p))}),e.qZA(),e.BQk()}if(2&r){const t=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(2,y,t.isDragover)),e.xp6(3),e.Q6J("ngIf",t.ffmpegService.isRunning)}}function k(r,a){if(1&r&&(e.TgZ(0,"p"),e._uU(1),e.ALo(2,"percent"),e.qZA()),2&r){const t=e.oxw(4);e.xp6(1),e.Oqu(e.lcZ(2,1,t.percentage))}}function z(r,a){if(1&r&&(e.TgZ(0,"app-alert",21)(1,"p"),e._uU(2),e.qZA(),e.YNc(3,k,3,3,"p",22),e.qZA()),2&r){const t=e.oxw(3);e.Q6J("color",t.alertColor),e.xp6(2),e.Oqu(t.alertMsg),e.xp6(1),e.Q6J("ngIf",t.showPercentage)}}const ue=function(r,a){return{"border-green-400":r,"border-transparent":a}};function pe(r,a){if(1&r){const t=e.EpF();e.TgZ(0,"div",23)(1,"img",24),e.NdJ("click",function(){const x=e.CHM(t).$implicit,O=e.oxw(3);return e.KtG(O.selectedScreenshot=x)}),e.ALo(2,"safeURL"),e.qZA()()}if(2&r){const t=a.$implicit,o=e.oxw(3);e.Q6J("ngClass",e.WLB(4,ue,t===o.selectedScreenshot,t!==o.selectedScreenshot)),e.xp6(1),e.Q6J("src",e.lcZ(2,2,t),e.LSH)}}const de=function(r,a){return{"opacity-50 bg-blue-400":r,"hover:bg-blue-700":a}};function fe(r,a){if(1&r){const t=e.EpF();e.YNc(0,z,4,3,"app-alert",11),e.TgZ(1,"form",12),e.NdJ("ngSubmit",function(){e.CHM(t);const p=e.oxw(2);return e.KtG(p.uploadFile())}),e.TgZ(2,"h2",13),e._uU(3,"Select a Thumbnail"),e.qZA(),e.TgZ(4,"div",14),e.YNc(5,pe,3,7,"div",15),e.qZA(),e.TgZ(6,"div",16)(7,"label",17),e._uU(8,"Title"),e.qZA(),e._UZ(9,"app-input",18),e.qZA(),e.TgZ(10,"div",19)(11,"button",20),e._uU(12," Publish "),e.qZA()()()}if(2&r){const t=e.oxw(2);e.Q6J("ngIf",t.showAlert),e.xp6(1),e.Q6J("formGroup",t.uploadForm),e.xp6(4),e.Q6J("ngForOf",t.screenshots),e.xp6(4),e.Q6J("control",t.title),e.xp6(2),e.Q6J("ngClass",e.WLB(5,de,t.inSubmission,!t.inSubmission))}}function ge(r,a){if(1&r&&(e.YNc(0,Q,6,4,"ng-container",6),e.YNc(1,fe,13,8,"ng-template",null,7,e.W1O)),2&r){const t=e.MAs(2),o=e.oxw();e.Q6J("ngIf",!o.dragDone)("ngIfElse",t)}}let me=(()=>{class r{constructor(t,o,p,x,O){this.storage=t,this.auth=o,this.clipService=p,this.router=x,this.ffmpegService=O,this.isDragover=!1,this.file=null,this.dragDone=!1,this.showAlert=!1,this.alertMsg="Uploading file please wait...",this.alertColor="blue",this.inSubmission=!1,this.percentage=0,this.showPercentage=!1,this.user=null,this.screenshots=[],this.selectedScreenshot="",this.title=new g.NI("",{validators:[g.kI.required,g.kI.minLength(3)],nonNullable:!0}),this.uploadForm=new g.cw({title:this.title}),o.user.subscribe(N=>this.user=N),this.ffmpegService.init()}ngOnDestroy(){this.task?.cancel()}storeFile(t){var o=this;return(0,U.Z)(function*(){o.ffmpegService.isRunning||(o.isDragover=!1,o.file=t.dataTransfer?t.dataTransfer?.files.item(0)??null:t.target.files?.item(0)??null,o.file&&"video/mp4"===o.file.type&&(o.screenshots=yield o.ffmpegService.getScreenshots(o.file),o.selectedScreenshot=o.screenshots[0],o.title.setValue(o.file.name.replace(/\.[^/.]+$/,"")),o.dragDone=!0))})()}uploadFile(){var t=this;return(0,U.Z)(function*(){t.inSubmission=!0,t.showPercentage=!0,t.showAlert=!0,t.alertColor="blue",t.alertMsg="Uploading file please wait...";const o=X(),p=`clips/${o}.mp4`,x=yield t.ffmpegService.blobFromURL(t.selectedScreenshot),O=`screenshots/${o}.png`;t.task=t.storage.upload(p,t.file);const N=t.storage.ref(p);t.screenshotTask=t.storage.upload(O,x);const ne=t.storage.ref(O);var q;(0,$.a)([t.task.percentageChanges(),t.screenshotTask.percentageChanges()]).subscribe(([q,ee])=>{q&&ee&&(t.percentage=(q+ee)/200)}),(0,M.D)([t.task.snapshotChanges(),t.screenshotTask.snapshotChanges()]).pipe((0,I.w)(()=>(0,M.D)([N.getDownloadURL(),ne.getDownloadURL()]))).subscribe({next:(q=(0,U.Z)(function*(ee){const[oe,Fe]=ee,Te={uid:t.user?.uid,displayName:t.user?.displayName,title:t.title.value,fileName:`${o}`,url:oe,screenshotURL:Fe,screenshotFileName:`${o}`,timestamp:re.Z.firestore.FieldValue.serverTimestamp()},Ue=yield t.clipService.createClip(Te);t.alertColor="green",t.alertMsg="File uploaded successfully",t.showPercentage=!1,setTimeout(()=>{t.router.navigate(["clip",Ue.id])},1e3)}),function(oe){return q.apply(this,arguments)}),error:q=>{t.alertColor="red",t.alertMsg="Upload failed, prease try again later",t.showPercentage=!1,t.inSubmission=!0,console.log(q)}})})()}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(i.Q1),e.Y36(n.zQ),e.Y36(D.Y),e.Y36(w.F0),e.Y36(d))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-upload"]],decls:8,vars:2,consts:[[1,"container","mx-auto","my-8","bg-secondary","p-6","upload-section"],[1,"rounded","relative","flex","flex-col"],[1,"font-bold","mb-6"],["class","material-symbols-outlined material-icon text-center text-6xl p-8 animate-spin",4,"ngIf","ngIfElse"],["uploadEditorCtr",""],[1,"material-symbols-outlined","material-icon","text-center","text-6xl","p-8","animate-spin"],[4,"ngIf","ngIfElse"],["uploadFormCtr",""],["app-event-blocker","",1,"w-full","px-10","py-40","rounded","text-center","cursor-pointer","border","border-dashed","border-gray-400","transition","duration-500","hover:text-white","hover:bg-blue-400","hover:border-blue-400","hover:border-solid","text-xl",3,"ngClass","dragend","dragover","dragenter","dragleave","mouseleave","drop"],["class","material-symbols-outlined material-icon text-center text-6xl p-8 animate-spin",4,"ngIf"],["type","file",1,"mt-4",3,"change"],[3,"color",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"mb-4","text-xl"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-4"],["class","border-8 cursor-pointer",3,"ngClass",4,"ngFor","ngForOf"],[1,"mt-4"],[1,"block","text-xl","mb-4"],["placeholder","Enter Title",3,"control"],[1,"mt-4","text-right"],["type","submit",1,"inline-flex","justify-center","py-2","px-4","border","border-transparent","shadow-sm","rounded-md","text-white","bg-blue-600","focus:outline-none",3,"ngClass"],[3,"color"],[4,"ngIf"],[1,"border-8","cursor-pointer",3,"ngClass"],[1,"border-transparent",3,"src","click"]],template:function(t,o){if(1&t&&(e.TgZ(0,"section",0)(1,"div",1)(2,"div",2),e._uU(3,"Upload Video"),e.qZA(),e.ynx(4),e.YNc(5,f,2,0,"span",3),e.BQk(),e.YNc(6,ge,3,2,"ng-template",null,4,e.W1O),e.qZA()()),2&t){const p=e.MAs(7);e.xp6(5),e.Q6J("ngIf",!o.ffmpegService.isReady)("ngIfElse",p)}},dependencies:[F.mk,F.sg,F.O5,A.w,V.a,u,g._Y,g.JL,g.sg,F.Zx,c],styles:[".upload-section[_ngcontent-%COMP%]{overflow:hidden}"]}),r})();var he=l(9635),se=l(4004),ve=l(5698);const ae=(0,se.U)(r=>!!r);let le=(()=>{class r{constructor(t,o){this.router=t,this.auth=o,this.canActivate=(p,x)=>{const O=p.data.authGuardPipe||(()=>ae);return this.auth.user.pipe((0,ve.q)(1),O(p,x),(0,se.U)(N=>"boolean"==typeof N?N:Array.isArray(N)?this.router.createUrlTree(N):this.router.parseUrl(N)))}}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(w.F0),e.LFG(n.zQ))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"any"}),r})();const ce=()=>("/",(0,he.z)(ae,(0,se.U)(a=>a||"/"))),_e=[{path:"manage",component:P,data:{authOnly:!0,authGuardPipe:ce},canActivate:[le]},{path:"upload",component:me,data:{authOnly:!0,authGuardPipe:ce},canActivate:[le]},{path:"manage-clips",redirectTo:"manage"}];let we=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[w.Bz.forChild(_e),w.Bz]}),r})();var xe=l(4466);let Ce=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[F.ez,we,xe.m,g.UX]}),r})()},7854:S=>{var C=function(l){"use strict";var h,F=Object.prototype,w=F.hasOwnProperty,U=Object.defineProperty||function(i,n,s){i[n]=s.value},e="function"==typeof Symbol?Symbol:{},D=e.iterator||"@@iterator",R=e.asyncIterator||"@@asyncIterator",g=e.toStringTag||"@@toStringTag";function A(i,n,s){return Object.defineProperty(i,n,{value:s,enumerable:!0,configurable:!0,writable:!0}),i[n]}try{A({},"")}catch{A=function(n,s,d){return n[s]=d}}function V(i,n,s,d){var b=Object.create((n&&n.prototype instanceof P?n:P).prototype),c=new K(d||[]);return U(b,"_invoke",{value:L(i,s,c)}),b}function J(i,n,s){try{return{type:"normal",arg:i.call(n,s)}}catch(d){return{type:"throw",arg:d}}}l.wrap=V;var _="suspendedStart",E="suspendedYield",v="executing",Z="completed",T={};function P(){}function $(){}function M(){}var I={};A(I,D,function(){return this});var Y=Object.getPrototypeOf,j=Y&&Y(Y(X([])));j&&j!==F&&w.call(j,D)&&(I=j);var G=M.prototype=P.prototype=Object.create(I);function W(i){["next","throw","return"].forEach(function(n){A(i,n,function(s){return this._invoke(n,s)})})}function H(i,n){function s(b,c,f,m){var y=J(i[b],i,c);if("throw"!==y.type){var Q=y.arg,k=Q.value;return k&&"object"==typeof k&&w.call(k,"__await")?n.resolve(k.__await).then(function(z){s("next",z,f,m)},function(z){s("throw",z,f,m)}):n.resolve(k).then(function(z){Q.value=z,f(Q)},function(z){return s("throw",z,f,m)})}m(y.arg)}var d;U(this,"_invoke",{value:function u(b,c){function f(){return new n(function(m,y){s(b,c,m,y)})}return d=d?d.then(f,f):f()}})}function L(i,n,s){var d=_;return function(b,c){if(d===v)throw new Error("Generator is already running");if(d===Z){if("throw"===b)throw c;return re()}for(s.method=b,s.arg=c;;){var f=s.delegate;if(f){var m=B(f,s);if(m){if(m===T)continue;return m}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(d===_)throw d=Z,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);d=v;var y=J(i,n,s);if("normal"===y.type){if(d=s.done?Z:E,y.arg===T)continue;return{value:y.arg,done:s.done}}"throw"===y.type&&(d=Z,s.method="throw",s.arg=y.arg)}}}function B(i,n){var s=n.method,d=i.iterator[s];if(d===h)return n.delegate=null,"throw"===s&&i.iterator.return&&(n.method="return",n.arg=h,B(i,n),"throw"===n.method)||"return"!==s&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+s+"' method")),T;var u=J(d,i.iterator,n.arg);if("throw"===u.type)return n.method="throw",n.arg=u.arg,n.delegate=null,T;var b=u.arg;return b?b.done?(n[i.resultName]=b.value,n.next=i.nextLoc,"return"!==n.method&&(n.method="next",n.arg=h),n.delegate=null,T):b:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,T)}function ie(i){var n={tryLoc:i[0]};1 in i&&(n.catchLoc=i[1]),2 in i&&(n.finallyLoc=i[2],n.afterLoc=i[3]),this.tryEntries.push(n)}function te(i){var n=i.completion||{};n.type="normal",delete n.arg,i.completion=n}function K(i){this.tryEntries=[{tryLoc:"root"}],i.forEach(ie,this),this.reset(!0)}function X(i){if(i){var n=i[D];if(n)return n.call(i);if("function"==typeof i.next)return i;if(!isNaN(i.length)){var s=-1,d=function u(){for(;++s<i.length;)if(w.call(i,s))return u.value=i[s],u.done=!1,u;return u.value=h,u.done=!0,u};return d.next=d}}return{next:re}}function re(){return{value:h,done:!0}}return $.prototype=M,U(G,"constructor",{value:M,configurable:!0}),U(M,"constructor",{value:$,configurable:!0}),$.displayName=A(M,g,"GeneratorFunction"),l.isGeneratorFunction=function(i){var n="function"==typeof i&&i.constructor;return!!n&&(n===$||"GeneratorFunction"===(n.displayName||n.name))},l.mark=function(i){return Object.setPrototypeOf?Object.setPrototypeOf(i,M):(i.__proto__=M,A(i,g,"GeneratorFunction")),i.prototype=Object.create(G),i},l.awrap=function(i){return{__await:i}},W(H.prototype),A(H.prototype,R,function(){return this}),l.AsyncIterator=H,l.async=function(i,n,s,d,u){void 0===u&&(u=Promise);var b=new H(V(i,n,s,d),u);return l.isGeneratorFunction(n)?b:b.next().then(function(c){return c.done?c.value:b.next()})},W(G),A(G,g,"Generator"),A(G,D,function(){return this}),A(G,"toString",function(){return"[object Generator]"}),l.keys=function(i){var n=Object(i),s=[];for(var d in n)s.push(d);return s.reverse(),function u(){for(;s.length;){var b=s.pop();if(b in n)return u.value=b,u.done=!1,u}return u.done=!0,u}},l.values=X,K.prototype={constructor:K,reset:function(i){if(this.prev=0,this.next=0,this.sent=this._sent=h,this.done=!1,this.delegate=null,this.method="next",this.arg=h,this.tryEntries.forEach(te),!i)for(var n in this)"t"===n.charAt(0)&&w.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=h)},stop:function(){this.done=!0;var n=this.tryEntries[0].completion;if("throw"===n.type)throw n.arg;return this.rval},dispatchException:function(i){if(this.done)throw i;var n=this;function s(m,y){return b.type="throw",b.arg=i,n.next=m,y&&(n.method="next",n.arg=h),!!y}for(var d=this.tryEntries.length-1;d>=0;--d){var u=this.tryEntries[d],b=u.completion;if("root"===u.tryLoc)return s("end");if(u.tryLoc<=this.prev){var c=w.call(u,"catchLoc"),f=w.call(u,"finallyLoc");if(c&&f){if(this.prev<u.catchLoc)return s(u.catchLoc,!0);if(this.prev<u.finallyLoc)return s(u.finallyLoc)}else if(c){if(this.prev<u.catchLoc)return s(u.catchLoc,!0)}else{if(!f)throw new Error("try statement without catch or finally");if(this.prev<u.finallyLoc)return s(u.finallyLoc)}}}},abrupt:function(i,n){for(var s=this.tryEntries.length-1;s>=0;--s){var d=this.tryEntries[s];if(d.tryLoc<=this.prev&&w.call(d,"finallyLoc")&&this.prev<d.finallyLoc){var u=d;break}}u&&("break"===i||"continue"===i)&&u.tryLoc<=n&&n<=u.finallyLoc&&(u=null);var b=u?u.completion:{};return b.type=i,b.arg=n,u?(this.method="next",this.next=u.finallyLoc,T):this.complete(b)},complete:function(i,n){if("throw"===i.type)throw i.arg;return"break"===i.type||"continue"===i.type?this.next=i.arg:"return"===i.type?(this.rval=this.arg=i.arg,this.method="return",this.next="end"):"normal"===i.type&&n&&(this.next=n),T},finish:function(i){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.finallyLoc===i)return this.complete(s.completion,s.afterLoc),te(s),T}},catch:function(i){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc===i){var d=s.completion;if("throw"===d.type){var u=d.arg;te(s)}return u}}throw new Error("illegal catch attempt")},delegateYield:function(i,n,s){return this.delegate={iterator:X(i),resultName:n,nextLoc:s},"next"===this.method&&(this.arg=h),T}},l}(S.exports);try{regeneratorRuntime=C}catch{"object"==typeof globalThis?globalThis.regeneratorRuntime=C:Function("r","regeneratorRuntime = r")(C)}},7156:S=>{function C(F,w,U,h,e,D,R){try{var g=F[D](R),A=g.value}catch(V){return void U(V)}g.done?w(A):Promise.resolve(A).then(h,e)}S.exports=function l(F){return function(){var w=this,U=arguments;return new Promise(function(h,e){var D=F.apply(w,U);function R(A){C(D,h,e,R,g,"next",A)}function g(A){C(D,h,e,R,g,"throw",A)}R(void 0)})}},S.exports.__esModule=!0,S.exports.default=S.exports},3681:S=>{"use strict";S.exports=JSON.parse('{"name":"@ffmpeg/ffmpeg","version":"0.11.6","description":"FFmpeg WebAssembly version","main":"src/index.js","types":"src/index.d.ts","directories":{"example":"examples"},"scripts":{"start":"node scripts/server.js","start:worker":"node scripts/worker-server.js","build":"rimraf dist && webpack --config scripts/webpack.config.prod.js","build:worker":"rimraf dist && webpack --config scripts/webpack.config.worker.prod.js","prepublishOnly":"npm run build","lint":"eslint src","wait":"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js","test":"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:browser:ffmpeg test:node:all","test:node":"node node_modules/mocha/bin/_mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a allow-file-access-from-files -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},"browser":{"./src/node/index.js":"./src/browser/index.js"},"repository":{"type":"git","url":"git+https://github.com/ffmpegwasm/ffmpeg.wasm.git"},"keywords":["ffmpeg","WebAssembly","video"],"author":"Jerome Wu <jeromewus@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/ffmpegwasm/ffmpeg.wasm/issues"},"engines":{"node":">=12.16.1"},"homepage":"https://github.com/ffmpegwasm/ffmpeg.wasm#readme","dependencies":{"is-url":"^1.2.4","node-fetch":"^2.6.1","regenerator-runtime":"^0.13.7","resolve-url":"^0.2.1"},"devDependencies":{"@babel/core":"^7.12.3","@babel/preset-env":"^7.12.1","@ffmpeg/core":"^0.11.0","@types/emscripten":"^1.39.4","babel-eslint":"^10.1.0","babel-loader":"^8.1.0","chai":"^4.2.0","cors":"^2.8.5","eslint":"^7.12.1","eslint-config-airbnb-base":"^14.1.0","eslint-plugin-import":"^2.22.1","express":"^4.17.1","mocha":"^8.2.1","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","wait-on":"^5.3.0","webpack":"^5.3.2","webpack-cli":"^4.1.0","webpack-dev-middleware":"^4.0.0"}}')}}]);